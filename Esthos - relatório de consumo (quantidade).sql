CREATE TABLE ARQTEMPPRD23750903(tipo_ape_exc VARCHAR2(1),codigo VARCHAR2(6));
CREATE TABLE ARQCREDEB23750903 (CRED_DEB VARCHAR2(1), SINAL NUMBER(5));
INSERT INTO ARQCREDEB23750903 VALUES ('D',1);
INSERT INTO ARQCREDEB23750903 VALUES ('C',-1);
CREATE TABLE ArqPrdSal23750903(PRD_SAL VARCHAR2(07), DESCRICAO VARCHAR2(70),  COD_ANT VARCHAR2(08), UNI_ESTOQU VARCHAR2(10),
            COD_SAL VARCHAR2(06), QTD_CONSUMO NUMBER(13,3), CUSTO NUMBER(15,3), CUSTO_TOT NUMBER(15,3), COD_SAL_APRESENT VARCHAR2(12),
            DESCR_APRESENT VARCHAR2(20), QTD_MES01 NUMBER(15,3), QTD_MES02 NUMBER(15,3), QTD_MES03 NUMBER(15,3), QTD_MES04 NUMBER(15,3),
            QTD_MES05 NUMBER(15,3), QTD_MES06 NUMBER(15,3), QTD_MES07 NUMBER(15,3), QTD_MES08 NUMBER(15,3), QTD_MES09 NUMBER(15,3),
            QTD_MES10 NUMBER(15,3), QTD_MES11 NUMBER(15,3), QTD_MES12 NUMBER(15,3), QTD_TOT_ANO NUMBER(15,3))

SELECT TIPO_PRD, DESCRICAO FROM FATIPCAD WHERE PRE_CLASS = 'MAT' 

SELECT FAPRDCAD.CODIGO,FAPRDCAD.DESCRICAO, FAPRDCAD.COD_ANT, FAPRDCAD.UNI_ESTOQU,ESSALPRD.COD_SAL,
SUM(ESMOVITE.QUANT * ARQCREDEB23750903.SINAL) QUANT, FAPRDCAD.COD_APRESENT, APRESENTACAO.DESCRICAO DESCR_APRESENT
FROM FAPRDCAD,FATIPCAD,ESMOVCAD,ESMOVITE,ARQCREDEB23750903,ESSALPRD, APRESENTACAO
WHERE FATIPCAD.PRE_CLASS = 'MAT'  And (ESMOVCAD.TIPO_DOCUMENTO = 'REQ'
Or (ESMOVCAD.TIPO_DOCUMENTO = 'ACE' And  ESMOVCAD.CRED_DEB = 'D'  And  ESMOVCAD.COD_MOT IN (SELECT COD_MOT FROM ESMOTCAD  WHERE EATU_CONS = 'S'))
OR (ESMOVCAD.TIPO_DOCUMENTO = 'ACE' AND  ESMOVCAD.CRED_DEB = 'D' AND  ESMOVCAD.COD_MOT IN (SELECT COD_MOT FROM ESMOTCAD  WHERE SATU_CONS='S')))
AND ESMOVCAD.DATA_MOV BETWEEN '28/09/2015' And '28/09/2015'  AND FAPRDCAD.TIPO_PRD  = FATIPCAD.TIPO_PRD  AND ESMOVCAD.DOCUMENTO = ESMOVITE.DOCUMENTO
AND ESMOVCAD.NOTA      = ESMOVITE.NOTA  AND ESMOVCAD.TIPO_DOCUMENTO = ESMOVITE.TIPO_DOCUMENTO  AND FAPRDCAD.CODIGO   = ESMOVITE.COD_PRD
AND ESMOVCAD.CRED_DEB = ARQCREDEB23750903.CRED_DEB  AND FAPRDCAD.COD_APRESENT = APRESENTACAO.COD_APRESENT (+)
AND FAPRDCAD.CODIGO = ESSALPRD.COD_PRD(+)  AND ESSALPRD.EH_PRINCIPAL(+) = 'S'
AND ESMOVCAD.SET_CON IN ('0016','0020','0024','0031','0032','0047','0066','0070','0085','0096','0108','0149','0155','0162','0182','0197',
'0260','0264','0289','0305','0321','0322','0331','0418','0419','0437','0447','0034','0037','0040','0059','0067','0076','0098','0109','0110',
'0120','0124','0136','0283','0313','0316','0338','0382','0402','0405','0406','0416','0435','0445','0022','0026','0046','0062','0065','0079',
'0088','0095','0107','0130','0134','0168','0169','0191','0303','0306','0320','0334','0389','0391','0409','0436','0456','0006','0012','0025',
'0030','0038','0041','0044','0055','0056','0061','0101','0111','0128','0161','0171','0199','0307','0323','0337','0360','0392','0396','0421',
'0434','0439','0450','0017','0018','0021','0054','0064','0086','0100','0104','0105','0106','0113','0118','0125','0132','0135','0154','0189',
'0190','0196','0294','0295','0302','0312','0315','0325','0343','0353','0362','0376','0431','0448','0455','0029','0045','0051','0052','0060',
'0074','0075','0077','0083','0084','0089','0090','0091','0099','0112','0158','0345','0415','0425','0429','0433','0004','0005','0014','0023',
'0027','0033','0036','0048','0049','0053','0058','0063','0069','0080','0087','0092','0114','0133','0147','0174','0175','0194','0251','0258',
'0290','0291','0296','0298','0317','0395','0400','0432','0440','0451','0453','0454','0007','0009','0011','0013','0015','0019','0028','0035',
'0039','0050','0057','0068','0071','0072','0073','0078','0081','0082','0097','0165','0176','0301','0329','0359','0361','0383','0390','0397',
'0417','0430') AND FAPRDCAD.TIPO_PRD  IN ('FIO')  AND FAPRDCAD.TIPO_CONS = '0' AND ESMOVITE.COD_BARRA_INT NOT IN
(SELECT COD_BARRA_INT FROM ESLOTE_VALIDADE WHERE FK_DOCUMENTO IS NOT NULL)  Group By  FAPRDCAD.CODIGO, FAPRDCAD.DESCRICAO,FAPRDCAD.COD_ANT,
FAPRDCAD.UNI_ESTOQU,ESSALPRD.COD_SAL,  FAPRDCAD.COD_APRESENT, APRESENTACAO.DESCRICAO  Order By FAPRDCAD.DESCRICAO 

INSERT INTO ArqPrdSal23750903 (PRD_SAL,DESCRICAO,COD_ANT,UNI_ESTOQU,COD_SAL,QTD_CONSUMO,CUSTO,CUSTO_TOT,COD_SAL_APRESENT,DESCR_APRESENT,
   QTD_MES01,QTD_MES02,QTD_MES03,QTD_MES04,QTD_MES05,   QTD_MES06,QTD_MES07,QTD_MES08,QTD_MES09,QTD_MES10,   QTD_MES11,QTD_MES12,QTD_TOT_ANO)
   VALUES  (0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)

SELECT * FROM ArqPrdSal23750903 ORDER BY PRD_SAL 

SELECT QTD_CONSUMO FROM ArqPrdSal23750903
