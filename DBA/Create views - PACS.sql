VIEWS -->

FD_EXAMES_KODAK:
--View alterada. Ver no final a view atual.
--create view admwpd.fd_exames_kodak (cod_uni,cod_pac,tipo_pac,cod_prd,regiao,data_hora_ped,data_mov,hora_mov,urgente,cod_pro,cod_pro_solic,cod_access_number,cod_sala,indicacao,obs,celular,tipo_comanda,comanda,celula,cod_pcn) as select x3.cod_ala ,x0.cod_pac ,x3.tipo_pac ,x2.cod_prd ,x2.regiao ,x0.data_mov ,x0.data_mov ,x0.hora_mov ,x2.urgente ,x2.cod_pro ,x2.cod_pro_solic ,x2.cod_access_number ,x2.cod_sala ,'' ,x0.observacao ,x4.celular ,x2.tipo_comanda ,x2.comanda ,x1.cod_cel ,x5.cod_pcn from admwpd.immovcad x0 ,admwpd.fa_set x1 ,admwpd.immovprd x2 ,admwpd.fapaccad x3 ,admwpd.faprtcad x4 ,admwpd.fapaccom x5 where ((((((x2.comanda = x0.comanda ) AND (x2.tipo_comanda = x0.tipo_comanda ) ) AND (x3.cod_prt = x4.cod_prt ) ) AND (x0.cod_pac = x3.cod_pac ) ) AND (x1.cod_set = x0.set_ima ) ) AND (x3.cod_pac = x5.cod_pac ) ) ;

create view admwpd.immov_cad (cod_uni,tipo_comanda,comanda,set_ima,set_req,cod_pac,cod_pro,data_mov,hora_mov,peso,altura,usu_recepcao,cod_pro_solic,tipo_entrega_exa,num_chamada,hora_atendimento,fim_atendimento,sobreaviso,instituicao,documento,observacao,dsc_indicacao_cli,consulta_antecip,num_pedido,cod_cid,justificativa_imc) as select x0.cod_uni ,x0.tipo_comanda ,x0.comanda ,x0.set_ima ,x0.set_req ,x0.cod_pac ,x0.cod_pro ,x0.data_mov ,x0.hora_mov ,x0.peso ,x0.altura ,x0.usu_recepcao ,x0.cod_pro_solic ,x0.tipo_entrega_exa ,x0.num_chamada ,x0.hora_atendimento ,x0.fim_atendimento ,x0.sobreaviso ,x0.instituicao ,x0.documento ,x0.observacao ,x0.dsc_indicacao_cli ,x0.consulta_antecip ,x0.num_pedido ,x0.cod_cid ,x0.justificativa_imc from immovcad x0 ;

create view admwpd.fa_set (cod_set,descricao,tipo_comanda,tipo_setor,tem_estoque,set_est,tem_quitacao,grupo,cod_cel,bloqueado,imp_sel_ped,ult_documento,cod_set_labs,tp_com_presc,cod_set_serv_aut,set_urg,cod_set_dist,imp_uni,imp_emb,imp_prod,imp_sel_ped_urg,cod_set_presc,hab_conf_transf,set_est_con,set_est_ped,ped_set_atu_est,conf_doc_inteiro,hab_inv_prd_natcon,fk_receita,sn_valid_presc_med,sn_valid_presc_cui,sn_mapa_item_valid) as select x0.cod_set ,x0.descricao ,x0.tipo_comanda ,x0.tipo_setor ,x0.tem_estoque ,x0.set_est ,x0.tem_quitacao ,x0.grupo ,x0.cod_cel ,x0.bloqueado ,x0.imp_sel_ped ,x0.ult_documento ,x0.cod_set_labs ,x0.tp_com_presc ,x0.cod_set_serv_aut ,x0.set_urg ,x0.cod_set_dist ,x0.imp_uni ,x0.imp_emb ,x0.imp_prod ,x0.imp_sel_ped_urg ,x0.cod_set_presc ,x0.hab_conf_transf ,x0.set_est_con ,x0.set_est_ped ,x0.ped_set_atu_est ,x0.conf_doc_inteiro ,x0.hab_inv_prd_natcon ,x0.fk_receita ,x0.tp_valid_presc_med ,x0.sn_valid_presc_cui ,x0.sn_mapa_item_valid from wpd.fasetcad x0 ;

create view admwpd.immov_prd (cod_uni,tipo_comanda,comanda,cod_prd,quant,dt_prev_entrega,dt_dig_laudo,hr_dig_laudo,usu_dig_laudo,dt_imp_laudo,hr_imp_laudo,usu_imp_laudo,dt_entrega,hr_entrega,usu_entrega,entregue_a,urgente,dt_rec_laudo,hr_rec_laudo,usu_rec_laudo,cod_sala,observacao,hr_prev_entrega,regiao,post_entrega,exa_atrasa,laudo_urg,cod_pro,cod_kit,dsc_ident_exame,cod_uni_marcacao,dt_lib_res,hr_lib_res,resp_lib_res,dt_lau_laudo,hr_lau_laudo,usu_lau_laudo,cod_access_number,cod_pro_solic,comanda_fathos,tp_comanda_fathos,cod_guia,cod_sen,cod_pro_tec) as select x0.cod_uni ,x0.tipo_comanda ,x0.comanda ,x0.cod_prd ,x0.quant ,x0.dt_prev_entrega ,x0.dt_dig_laudo ,x0.hr_dig_laudo ,x0.usu_dig_laudo ,x0.dt_imp_laudo ,x0.hr_imp_laudo ,x0.usu_imp_laudo ,x0.dt_entrega ,x0.hr_entrega ,x0.usu_entrega ,x0.entregue_a ,x0.urgente ,x0.dt_rec_laudo ,x0.hr_rec_laudo ,x0.usu_rec_laudo ,x0.cod_sala ,x0.observacao ,x0.hr_prev_entrega ,x0.regiao ,x0.post_entrega ,x0.exa_atrasa ,x0.laudo_urg ,x0.cod_pro ,x0.cod_kit ,x0.dsc_ident_exame ,x0.cod_uni_marcacao ,x0.dt_lib_res ,x0.hr_lib_res ,x0.resp_lib_res ,x0.dt_lau_laudo ,x0.hr_lau_laudo ,x0.usu_lau_laudo ,x0.cod_access_number ,x0.cod_pro_solic ,x0.comanda_fathos ,x0.tp_comanda_fathos ,x0.cod_guia ,x0.cod_sen ,x0.cod_pro_tec from immovprd x0;

create view admwpd.fapac_cad (cod_pac,cod_prt,leito,tipo,tip_atend,cod_ala,tipo_pac,data_ent,hora_ent,data_prsai,hora_prsai,nome_rsp,end_rsp,bai_rsp,cid_rsp,est_rsp,cep_rsp,prof_rsp,fone_rsp,ident_rsp,cpf_rsp,nome_segu,fone_segu,data_alta,hora_alta,moti_alta,termo,cod_con,cod_pla,senha,num_guia,val_guia,matricula,cod_pro,cod_pro_sa,f_caudep,f_cauret,f_parcial,f_guia,f_val_guia,f_cob_parcial,f_teto_inamps,val_caucao,val_parcial,obs1,dum,medicamento_uso,observacao,suspenso,cod_mae,local_entrega,posto_coleta,ult_dtxaut,cod_sub,direito_aco,direito_ali_aco,direito_tel,acidente_trab,caso_policial,conta_fechada,inibe_pedido,valor_ch,valor_filme,valor_mat_tax,ocorrencia_atend,cod_uni,data_lim_ped,hora_lim_ped,val_cau_part_sguia,cod_matricula,cod_sistema,cpf_segurado,cod_ident_segurado,cod_lote,cod_esp,controle_consulta,data_alta_medica,medico_alta_medica,condicoes_rn,obito_materno,dt_autorizacao,assinatura_guia,id_reg,aborto,dura_gestacao,tipo_gravidez,tipo_parto,n_cons_pre_nata,num_filhos_vivos,num_filhos_mortos,apgar_1_min,apgar_5_min,atend_neo_natal,peso,gemelar,cod_cid,alta_med_medview,cod_rsv,tipo_rsv,cod_mot_alta,ind_day_clinic,tip_atend_tiss,obs_alta,qtd_sessao_pac,ref_arq) as select x0.cod_pac ,x0.cod_prt ,x0.leito ,x0.tipo ,x0.tip_atend ,x0.cod_ala ,x0.tipo_pac ,x0.data_ent ,x0.hora_ent ,x0.data_prsai ,x0.hora_prsai ,x0.nome_rsp ,x0.end_rsp ,x0.bai_rsp ,x0.cid_rsp ,x0.est_rsp ,x0.cep_rsp ,x0.prof_rsp ,x0.fone_rsp ,x0.ident_rsp ,x0.cpf_rsp ,x0.nome_segu ,x0.fone_segu ,x0.data_alta ,x0.hora_alta ,x0.moti_alta ,x0.termo ,x0.cod_con ,x0.cod_pla ,x0.senha ,x0.num_guia ,x0.val_guia ,x0.matricula ,x0.cod_pro ,x0.cod_pro_sa ,x0.f_caudep ,x0.f_cauret ,x0.f_parcial ,x0.f_guia ,x0.f_val_guia ,x0.f_cob_parcial ,x0.f_teto_inamps ,x0.val_caucao ,x0.val_parcial ,x0.obs1 ,x0.dum ,x0.medicamento_uso ,x0.observacao ,x0.suspenso ,x0.cod_mae ,x0.local_entrega ,x0.posto_coleta ,x0.ult_dtxaut ,x0.cod_sub ,x0.direito_aco ,x0.direito_ali_aco ,x0.direito_tel ,x0.acidente_trab ,x0.caso_policial ,x0.conta_fechada ,x0.inibe_pedido ,x0.valor_ch ,x0.valor_filme ,x0.valor_mat_tax ,x0.ocorrencia_atend ,x0.cod_uni ,x0.data_lim_ped ,x0.hora_lim_ped ,x0.val_cau_part_sguia ,x0.cod_matricula ,x0.cod_sistema ,x0.cpf_segurado ,x0.cod_ident_segurado ,x0.cod_lote ,x0.cod_esp ,x0.controle_consulta ,x0.data_alta_medica ,x0.medico_alta_medica ,x0.condicoes_rn ,x0.obito_materno ,x0.dt_autorizacao ,x0.assinatura_guia ,x0.id_reg ,x0.aborto ,x0.dura_gestacao ,x0.tipo_gravidez ,x0.tipo_parto ,x0.n_cons_pre_nata ,x0.num_filhos_vivos ,x0.num_filhos_mortos ,x0.apgar_1_min ,x0.apgar_5_min ,x0.atend_neo_natal ,x0.peso ,x0.gemelar ,x0.cod_cid ,x0.alta_med_medview ,x0.cod_rsv ,x0.tipo_rsv ,x0.cod_mot_alta ,x0.ind_day_clinic ,x0.tip_atend_tiss ,x0.obs_alta ,x0.qtd_sessao_pac ,x0.ref_arq from fapaccad x0 ;

create view admwpd.faprt_cad (cod_prt,tela_cheia,nome_pac,nome_mae,nome_pai,est_civil,nome_conjuge,nascimento,sexo,cor,profissao,identidade,cpf,natural_de,qtd_filhos,fone_res,end_res,bai_res,cid_res,est_res,cep_res,nacionalidade,religiao,empresa,end_trab,bai_trab,cid_trab,est_trab,cep_trab,fone_trab,inadimplente,obs1,same,arq_morto,ponto_ref,arq_medico,aih_pis_pasep,aih_cat,aih_cod_nacional,cod_hospital,end_numero,end_complemento,cod_prt_corp,data_abertu,cod_uni,cod_rel,data_mov_arq_morto,data_obito,cartao_sus,pais_res,tipo_sangue,dsc_email,num_pis_pasep,num_cert_nasc,doador_org,celular,data_emiss_id,uf_naturalidade,orgao_emissor_id,chave_ident,senha_ident,hora_ent_prt,cod_matricula_prt,res_exa_email,res_exa_sms,tratamento,ref_arq,cod_cbo) as select x0.cod_prt ,x0.tela_cheia ,x0.nome_pac ,x0.nome_mae ,x0.nome_pai ,x0.est_civil ,x0.nome_conjuge ,x0.nascimento ,x0.sexo ,x0.cor ,x0.profissao ,x0.identidade ,x0.cpf ,x0.natural_de ,x0.qtd_filhos ,x0.fone_res ,x0.end_res ,x0.bai_res ,x0.cid_res ,x0.est_res ,x0.cep_res ,x0.nacionalidade ,x0.religiao ,x0.empresa ,x0.end_trab ,x0.bai_trab ,x0.cid_trab ,x0.est_trab ,x0.cep_trab ,x0.fone_trab ,x0.inadimplente ,x0.obs1 ,x0.same ,x0.arq_morto ,x0.ponto_ref ,x0.arq_medico ,x0.aih_pis_pasep ,x0.aih_cat ,x0.aih_cod_nacional ,x0.cod_hospital ,x0.end_numero ,x0.end_complemento ,x0.cod_prt_corp ,x0.data_abertu ,x0.cod_uni ,x0.cod_rel ,x0.data_mov_arq_morto ,x0.data_obito ,x0.cartao_sus ,x0.pais_res ,x0.tipo_sangue ,x0.dsc_email ,x0.num_pis_pasep ,x0.num_cert_nasc ,x0.doador_org ,x0.celular ,x0.data_emiss_id ,x0.uf_naturalidade ,x0.orgao_emissor_id ,x0.chave_ident ,x0.senha_ident ,x0.hora_ent_prt ,x0.cod_matricula_prt ,x0.res_exa_email ,x0.res_exa_sms ,x0.tratamento ,x0.ref_arq ,x0.cod_cbo from faprtcad x0 ;

create view admwpd.fapac_com (cod_pac,data_nasc_rsp,nome_pai_rsp,nome_mae_rsp,org_emissor,num_cheque_cau,banco,agencia,conta,bens_rsp_1,bens_rsp_2,bens_rsp_3,nacional_rsp,est_civil_rsp,eletiva_emergencia,tipo_guia,cond_atendimento,horario_urgencia,reconsulta,codigo_empresa,cpf_cgc,controle_imp,serie_doc,numero_doc,autorizacao,atend_pa_pps,eh_politrauma,encaminhado_por,cod_enc,cod_pcn,diagnostico,tratamento,origem,obs2,lote_sol_guia,lote_ren_guia,cod_ocorre,acompanhante,usa_oxigenio,tipo_fisioterapia,qtd_horas_enferm,qtd_fisioterap,zona_residencial,regional,atendente,especialidade,nom_atend_conv,nom_medico_conv,ind_envio_online,num_pis_pasep_resp,num_cert_nasc_resp,filmagem,validade_carteira,cod_pro_indicante,cod_set,data_emiss_id_resp,uf_naturalid_resp,natural_de_resp,conjuge_rsp,end_numero_resp,end_complem_resp,num_atestado_obito,num_prod,num_atestado_nasc) as select x0.cod_pac ,x0.data_nasc_rsp ,x0.nome_pai_rsp ,x0.nome_mae_rsp ,x0.org_emissor ,x0.num_cheque_cau ,x0.banco ,x0.agencia ,x0.conta ,x0.bens_rsp_1 ,x0.bens_rsp_2 ,x0.bens_rsp_3 ,x0.nacional_rsp ,x0.est_civil_rsp ,x0.eletiva_emergencia ,x0.tipo_guia ,x0.cond_atendimento ,x0.horario_urgencia ,x0.reconsulta ,x0.codigo_empresa ,x0.cpf_cgc ,x0.controle_imp ,x0.serie_doc ,x0.numero_doc ,x0.autorizacao ,x0.atend_pa_pps ,x0.eh_politrauma ,x0.encaminhado_por ,x0.cod_enc ,x0.cod_pcn ,x0.diagnostico ,x0.tratamento ,x0.origem ,x0.obs2 ,x0.lote_sol_guia ,x0.lote_ren_guia ,x0.cod_ocorre ,x0.acompanhante ,x0.usa_oxigenio ,x0.tipo_fisioterapia ,x0.qtd_horas_enferm ,x0.qtd_fisioterap ,x0.zona_residencial ,x0.regional ,x0.atendente ,x0.especialidade ,x0.nom_atend_conv ,x0.nom_medico_conv ,x0.ind_envio_online ,x0.num_pis_pasep_resp ,x0.num_cert_nasc_resp ,x0.filmagem ,x0.validade_carteira ,x0.cod_pro_indicante ,x0.cod_set ,x0.data_emiss_id_resp ,x0.uf_naturalid_resp ,x0.natural_de_resp ,x0.conjuge_rsp ,x0.end_numero_resp ,x0.end_complem_resp ,x0.num_atestado_obito ,x0.num_prod ,x0.num_atestado_nasc from fapaccom x0 ;


FAPRDCAD:
create view admwpd.faprd_cad (codigo,cod_ant,cod_alt,cod_amb,cod_barras,descricao,descricao_comp,mnemonico,tipo_prd,lin_mat,gru_est,gru_exa,cod_instr_pac,cod_instr_col,cod_gru,uni_compra,uni_distri,uni_estoqu,divisor,fator,estoq_dist,tipo_cons,num_aux,porte_anes,perc_hospi,saldo_emp,saldo_mov,ped_min,est_min,est_atu,qtd_pen,custo_med,cus_medind,custo_atu,bo,qtd_ultmov,doc_ultmov,mov_ultmov,tim_ultmov,for_ultmov,des_ultcom,ult_ped,ult_compra,dat_ultmov,dat_ultcon,qtd_dias_res,duracao,cod_met,tipo_laudo,cod_lab,agrupa_laudo,valor_minimo,valor_maximo,qtd_etiquetas,imp_etiqueta,cod_bras,data_cad,sexo,em_balanco,classificacao,bloqueado,ponto_ressupr,cod_sal,cod_gcn,cod_prd_corp,cod_abramge,cod_prd_aih,preco_fabrica,cod_bancada,incidencia,cod_prd_amb,estoque_minimo,class_estoque,class_consumo,class_compras,exigir_prescricao,importado,cod_sus,pct_taxa_admin,nom_fabric_padrao,ind_imprime_etiq,cod_simpro,prd_lib,permite_retorno,ult_atu_bras,ind_antimicrobiano,ind_prd_consultas,ind_tax_proc_real,prof_prd_comanda,isento_impostos,cod_categ,tipo_diaria,cod_apresent,qtd_dias_antimicrb,cod_cbhpm,porte_anes_cbhpm,cod_unid_vel,prod_nao_padr,id_class_consulta,cod_bras_tiss,cod_fabric_padrao,ind_cont_ses_atd,modelo_comercial,num_serie,num_registro,data_val_forn,data_val_import,exibe_iten_kitpres,alter_iten_kitpres) as select x0.codigo ,x0.cod_ant ,x0.cod_alt ,x0.cod_amb ,x0.cod_barras ,x0.descricao ,x0.descricao_comp ,x0.mnemonico ,x0.tipo_prd ,x0.lin_mat ,x0.gru_est ,x0.gru_exa ,x0.cod_instr_pac ,x0.cod_instr_col ,x0.cod_gru ,x0.uni_compra ,x0.uni_distri ,x0.uni_estoqu ,x0.divisor ,x0.fator ,x0.estoq_dist ,x0.tipo_cons ,x0.num_aux ,x0.porte_anes ,x0.perc_hospi ,x0.saldo_emp ,x0.saldo_mov ,x0.ped_min ,x0.est_min ,x0.est_atu ,x0.qtd_pen ,x0.custo_med ,x0.cus_medind ,x0.custo_atu ,x0.bo ,x0.qtd_ultmov ,x0.doc_ultmov ,x0.mov_ultmov ,x0.tim_ultmov ,x0.for_ultmov ,x0.des_ultcom ,x0.ult_ped ,x0.ult_compra ,x0.dat_ultmov ,x0.dat_ultcon ,x0.qtd_dias_res ,x0.duracao ,x0.cod_met ,x0.tipo_laudo ,x0.cod_lab ,x0.agrupa_laudo ,x0.valor_minimo ,x0.valor_maximo ,x0.qtd_etiquetas ,x0.imp_etiqueta ,x0.cod_bras ,x0.data_cad ,x0.sexo ,x0.em_balanco ,x0.classificacao ,x0.bloqueado ,x0.ponto_ressupr ,x0.cod_sal ,x0.cod_gcn ,x0.cod_prd_corp ,x0.cod_abramge ,x0.cod_prd_aih ,x0.preco_fabrica ,x0.cod_bancada ,x0.incidencia ,x0.cod_prd_amb ,x0.estoque_minimo ,x0.class_estoque ,x0.class_consumo ,x0.class_compras ,x0.exigir_prescricao ,x0.importado ,x0.cod_sus ,x0.pct_taxa_admin ,x0.nom_fabric_padrao ,x0.ind_imprime_etiq ,x0.cod_simpro ,x0.prd_lib ,x0.permite_retorno ,x0.ult_atu_bras ,x0.ind_antimicrobiano ,x0.ind_prd_consultas ,x0.ind_tax_proc_real ,x0.prof_prd_comanda ,x0.isento_impostos ,x0.cod_categ ,x0.tipo_diaria ,x0.cod_apresent ,x0.qtd_dias_antimicrb ,x0.cod_cbhpm ,x0.porte_anes_cbhpm ,x0.cod_unid_vel ,x0.prod_nao_padr ,x0.id_class_consulta ,x0.cod_bras_tiss ,x0.cod_fabric_padrao ,x0.ind_cont_ses_atd ,x0.modelo_comercial ,x0.num_serie ,x0.num_registro ,x0.data_val_forn ,x0.data_val_import ,x0.exibe_iten_kitpres ,x0.alter_iten_kitpres from faprdcad x0 ;

FD_PROFISSIONAIS:
create view admwpd.fd_profissionais (cod_pro,nome_pro,data_nascimento,end,bairro,cidade,estado,cep,fone,celular,email,cpf,crm,crmok) as select x0.cod_pro ,x0.nome_pro ,x0.data_nascimento ,x0.end ,x0.bairro_res ,x0.cidade_res ,x0.estado_res ,x0.cep_res ,x0.fone_res ,x0.fone_celular ,x0.email ,x0.cpf ,(SUBSTR (x0.cod_tp_conselho ,2 ,3 )|| x0.crm ) ,x0.crm from admwpd.faprocad x0 ;

create view admwpd.fapro_cad (cod_pro,crm,uf_crm,cpf,nome_pro,end,bairro_res,cidade_res,estado_res,cep_res,fone_res,fone_celular,bip_pager,end_tra,bairro_tra,cidade_tra,estado_tra,cep_tra,fone_tra,perc_hosp,perc_impos,recibo,staff,banco,agencia,conta,ult_ender,ult_prof,aih_equipe,aih_apelido,aih_nome_abrev,vinculo,cod_hospital,grupo,qtd_atend_extra,cod_ant,funcionario,cod_pro_corp,digita_setor,docente,inativo,cod_profissao,data_nascimento,matricula,nome_reduzido,cod_lote,ind_perm_intern,ind_perm_ass_laudo,tipo_pagto,email,cta_provisao_mega,cta_adianta_mega,cod_movto_mega,classe_finan_mega,repasse_grupo_mega,tipo_pac_autoriz,chave_ident,cod_tp_conselho,ind_plantao,ind_status,cod_cnes,cod_tipo_lograd_re,complemento_res,numero_res,cod_tipo_lograd_tr,complemento_trab,numero_trab,tratamento) as select x0.cod_pro ,x0.crm ,x0.uf_crm ,x0.cpf ,x0.nome_pro ,x0.end ,x0.bairro_res ,x0.cidade_res ,x0.estado_res ,x0.cep_res ,x0.fone_res ,x0.fone_celular ,x0.bip_pager ,x0.end_tra ,x0.bairro_tra ,x0.cidade_tra ,x0.estado_tra ,x0.cep_tra ,x0.fone_tra ,x0.perc_hosp ,x0.perc_impos ,x0.recibo ,x0.staff ,x0.banco ,x0.agencia ,x0.conta ,x0.ult_ender ,x0.ult_prof ,x0.aih_equipe ,x0.aih_apelido ,x0.aih_nome_abrev ,x0.vinculo ,x0.cod_hospital ,x0.grupo ,x0.qtd_atend_extra ,x0.cod_ant ,x0.funcionario ,x0.cod_pro_corp ,x0.digita_setor ,x0.docente ,x0.inativo ,x0.cod_profissao ,x0.data_nascimento ,x0.matricula ,x0.nome_reduzido ,x0.cod_lote ,x0.ind_perm_intern ,x0.ind_perm_ass_laudo ,x0.tipo_pagto ,x0.email ,x0.cta_provisao_mega ,x0.cta_adianta_mega ,x0.cod_movto_mega ,x0.classe_finan_mega ,x0.repasse_grupo_mega ,x0.tipo_pac_autoriz ,x0.chave_ident ,x0.cod_tp_conselho ,x0.ind_plantao ,x0.ind_status ,x0.cod_cnes ,x0.cod_tipo_lograd_re ,x0.complemento_res ,x0.numero_res ,x0.cod_tipo_lograd_tr ,x0.complemento_trab ,x0.numero_trab ,x0.tratamento from faprocad x0 ;

FD_PACIENTE:
create view admwpd.fd_paciente (cod_prt,cod_pac,tipo_pac,leito,data_ent,hora_ent,data_alta,hora_alta,nome_pac,nascimento,end_res,bai_res,cid_res,est_res,cep_res,fone_res,altura,peso,dsc_email,identidade,cpf,sexo,cod_con,fantasia,matricula,dum,pac_u_i,celular,res_exa_email,res_exa_sms,est_civil,bairro_res) as select x0.cod_prt ,x1.cod_pac ,x1.tipo_pac ,x1.leito ,x1.data_ent ,x1.hora_ent ,x1.data_alta ,x1.hora_alta ,x0.nome_pac ,x0.nascimento ,x0.end_res ,x0.bai_res ,x0.cid_res ,x0.est_res ,x0.cep_res ,x0.fone_res ,(select max(x3.altura ) from admwpd.immovcad x3 where (x3.cod_pac = x1.cod_pac ) ) ,(select max(x4.peso ) from admwpd.immovcad x4 where (x4.cod_pac = x1.cod_pac ) ) ,x0.dsc_email ,x0.identidade ,x0.cpf ,x0.sexo ,x2.cod_con ,x2.fantasia ,x1.matricula ,x1.dum ,CASE WHEN ((select count(*) from admwpd.fapaccad x5 where ((((x1.tipo_pac = 'U' ) AND (x5.tipo_pac = 'I' ) ) AND (x5.cod_prt = x1.cod_prt ) ) AND (x5.data_ent = x1.data_ent ) ) ) > 0. )  THEN 'S'  ELSE 'N'  END ,x0.celular ,x0.res_exa_email ,x0.res_exa_sms ,x0.est_civil ,x0.bai_res from admwpd.faprtcad x0 ,admwpd.fapaccad x1 ,admwpd.faconcad x2 where ((x0.cod_prt = x1.cod_prt ) AND (x1.cod_con = x2.cod_con ) ) ;

create view admwpd.fa_pac (cod_pac,cod_prt,leito,tipo,tip_atend,cod_ala,tipo_pac,data_ent,hora_ent,data_prsai,hora_prsai,nome_rsp,end_rsp,bai_rsp,cid_rsp,est_rsp,cep_rsp,prof_rsp,fone_rsp,ident_rsp,cpf_rsp,nome_segu,fone_segu,data_alta,hora_alta,moti_alta,termo,cod_con,cod_pla,senha,num_guia,val_guia,matricula,cod_pro,cod_pro_sa,f_caudep,f_cauret,f_parcial,f_guia,f_val_guia,f_cob_parcial,f_teto_inamps,val_caucao,val_parcial,obs1,dum,medicamento_uso,observacao,suspenso,cod_mae,local_entrega,posto_coleta,ult_dtxaut,cod_sub,direito_aco,direito_ali_aco,direito_tel,acidente_trab,caso_policial,conta_fechada,inibe_pedido,valor_ch,valor_filme,valor_mat_tax,ocorrencia_atend,cod_uni,data_lim_ped,hora_lim_ped,val_cau_part_sguia,cod_matricula,cod_sistema,cpf_segurado,cod_ident_segurado,cod_lote,cod_esp,controle_consulta,data_alta_medica,medico_alta_medica,condicoes_rn,obito_materno,dt_autorizacao,assinatura_guia,id_reg,aborto,dura_gestacao,tipo_gravidez,tipo_parto,n_cons_pre_nata,num_filhos_vivos,num_filhos_mortos,apgar_1_min,apgar_5_min,atend_neo_natal,peso,gemelar,cod_cid,alta_med_medview,cod_rsv,tipo_rsv,cod_mot_alta,ind_day_clinic,tip_atend_tiss,obs_alta,qtd_sessao_pac,ref_arq) as select x0.cod_pac ,x0.cod_prt ,x0.leito ,x0.tipo ,x0.tip_atend ,x0.cod_ala ,x0.tipo_pac ,x0.data_ent ,x0.hora_ent ,x0.data_prsai ,x0.hora_prsai ,x0.nome_rsp ,x0.end_rsp ,x0.bai_rsp ,x0.cid_rsp ,x0.est_rsp ,x0.cep_rsp ,x0.prof_rsp ,x0.fone_rsp ,x0.ident_rsp ,x0.cpf_rsp ,x0.nome_segu ,x0.fone_segu ,x0.data_alta ,x0.hora_alta ,x0.moti_alta ,x0.termo ,x0.cod_con ,x0.cod_pla ,x0.senha ,x0.num_guia ,x0.val_guia ,x0.matricula ,x0.cod_pro ,x0.cod_pro_sa ,x0.f_caudep ,x0.f_cauret ,x0.f_parcial ,x0.f_guia ,x0.f_val_guia ,x0.f_cob_parcial ,x0.f_teto_inamps ,x0.val_caucao ,x0.val_parcial ,x0.obs1 ,x0.dum ,x0.medicamento_uso ,x0.observacao ,x0.suspenso ,x0.cod_mae ,x0.local_entrega ,x0.posto_coleta ,x0.ult_dtxaut ,x0.cod_sub ,x0.direito_aco ,x0.direito_ali_aco ,x0.direito_tel ,x0.acidente_trab ,x0.caso_policial ,x0.conta_fechada ,x0.inibe_pedido ,x0.valor_ch ,x0.valor_filme ,x0.valor_mat_tax ,x0.ocorrencia_atend ,x0.cod_uni ,x0.data_lim_ped ,x0.hora_lim_ped ,x0.val_cau_part_sguia ,x0.cod_matricula ,x0.cod_sistema ,x0.cpf_segurado ,x0.cod_ident_segurado ,x0.cod_lote ,x0.cod_esp ,x0.controle_consulta ,x0.data_alta_medica ,x0.medico_alta_medica ,x0.condicoes_rn ,x0.obito_materno ,x0.dt_autorizacao ,x0.assinatura_guia ,x0.id_reg ,x0.aborto ,x0.dura_gestacao ,x0.tipo_gravidez ,x0.tipo_parto ,x0.n_cons_pre_nata ,x0.num_filhos_vivos ,x0.num_filhos_mortos ,x0.apgar_1_min ,x0.apgar_5_min ,x0.atend_neo_natal ,x0.peso ,x0.gemelar ,x0.cod_cid ,x0.alta_med_medview ,x0.cod_rsv ,x0.tipo_rsv ,x0.cod_mot_alta ,x0.ind_day_clinic ,x0.tip_atend_tiss ,x0.obs_alta ,x0.qtd_sessao_pac ,x0.ref_arq from fapaccad x0 ;

create view admwpd.facon_cad (cod_con,cgc,rsocial,fantasia,cod_gru,endereco,bairro,cidade,estado,telefone,contato,dias_retorno,usa_cod_equiv,insc_estadual,insc_municipal,eh_golden,qtd_fat_rem,cod_con_corp,perc_retorno,codigo_hospital,perc_urg,ind_imp_proc_real,cod_nacional_ms,ind_envio_online,perc_urg_foc,ind_inativo,ind_pac_comp_rem,imprime_fabricante,agrupa_fat_per,end_numero,cep_con,cod_ban,cod_age,conta_corrente,imp_not_rem_pac,qtd_pac_fat_urg,qtd_pac_rem,cargo_contato,fone_contato,cta_provisao_mega,cta_adianta_mega,cod_movto_mega,chave_ident,imp_fat_agrup_dat,cod_cli_rm,tab_rec_dep_int_rm,tab_rec_dep_ext_rm,cod_conta_caixa_rm,ind_ctb_crc_mega,mascara_matricula,recolhe_iss_quit,forma_pgto,sit_tit_int,cod_func_dig_verif,matricula_guia,matricula_senha,util_elegibilidade,interface_elegib,num_ans,des_obg_procreal,imp_fatura_audit,ind_lib_dup_guia,logomarca,ind_gera_guia,dat_presc_comand,imp_bras_fatura,tp_impr_nota,email) as select x0.cod_con ,x0.cgc ,x0.rsocial ,x0.fantasia ,x0.cod_gru ,x0.endereco ,x0.bairro ,x0.cidade ,x0.estado ,x0.telefone ,x0.contato ,x0.dias_retorno ,x0.usa_cod_equiv ,x0.insc_estadual ,x0.insc_municipal ,x0.eh_golden ,x0.qtd_fat_rem ,x0.cod_con_corp ,x0.perc_retorno ,x0.codigo_hospital ,x0.perc_urg ,x0.ind_imp_proc_real ,x0.cod_nacional_ms ,x0.ind_envio_online ,x0.perc_urg_foc ,x0.ind_inativo ,x0.ind_pac_comp_rem ,x0.imprime_fabricante ,x0.agrupa_fat_per ,x0.end_numero ,x0.cep_con ,x0.cod_ban ,x0.cod_age ,x0.conta_corrente ,x0.imp_not_rem_pac ,x0.qtd_pac_fat_urg ,x0.qtd_pac_rem ,x0.cargo_contato ,x0.fone_contato ,x0.cta_provisao_mega ,x0.cta_adianta_mega ,x0.cod_movto_mega ,x0.chave_ident ,x0.imp_fat_agrup_dat ,x0.cod_cli_rm ,x0.tab_rec_dep_int_rm ,x0.tab_rec_dep_ext_rm ,x0.cod_conta_caixa_rm ,x0.ind_ctb_crc_mega ,x0.mascara_matricula ,x0.recolhe_iss_quit ,x0.forma_pgto ,x0.sit_tit_int ,x0.cod_func_dig_verif ,x0.matricula_guia ,x0.matricula_senha ,x0.util_elegibilidade ,x0.interface_elegib ,x0.num_ans ,x0.des_obg_procreal ,x0.imp_fatura_audit ,x0.ind_lib_dup_guia ,x0.logomarca ,x0.ind_gera_guia ,x0.dat_presc_comand ,x0.imp_bras_fatura ,x0.tp_impr_nota ,x0.email from faconcad x0 ;

FD_PACIENTE2: 
create view admwpd.fd_paciente2 (cod_prt,cod_pac,tipo_pac,leito,data_ent,hora_ent,data_alta,hora_alta,nome_pac,nascimento,end_res,bai_res,
cid_res,est_res,cep_res,fone_res,altura,peso,dsc_email,identidade,cpf,sexo,cod_con,fantasia,matricula,dum,pac_u_i,celular,res_exa_email,
res_exa_sms,est_civil,cod_pla,nomeplano,profissao,origem)
as select x0.cod_prt ,x1.cod_pac ,x1.tipo_pac ,x1.leito ,x1.data_ent ,x1.hora_ent,
x1.data_alta ,x1.hora_alta ,x0.nome_pac ,x0.nascimento ,x0.end_res ,x0.bai_res ,x0.cid_res ,x0.est_res ,x0.cep_res ,x0.fone_res,
(select max(x5.altura ) from admwpd.immovcad x5 where (x5.cod_pac = x1.cod_pac ) ),
(select max(x6.peso ) from admwpd.immovcad x6 where (x6.cod_pac = x1.cod_pac ) ),
x0.dsc_email ,x0.identidade ,x0.cpf ,x0.sexo ,x2.cod_con ,x2.fantasia ,x1.matricula ,x1.dum,
CASE WHEN ((select count(*) from admwpd.fapaccad x7 where ((((x1.tipo_pac = 'U' ) AND (x7.tipo_pac = 'I' ) ) AND (x7.cod_prt = x1.cod_prt ) )
AND (x7.data_ent = x1.data_ent ) ) ) > 0. )  THEN 'S'  ELSE 'N'  END,
x0.celular ,x0.res_exa_email ,x0.res_exa_sms ,x0.est_civil ,x1.cod_pla ,x3.nome_plano ,x0.profissao ,x4.origem
from admwpd.faprtcad x0 ,admwpd.fapaccad x1 ,admwpd.faconcad x2 ,admwpd.faplacad x3, admwpd.fapaccom x4 
where (((((x0.cod_prt = x1.cod_prt ) AND (x1.cod_con = x2.cod_con ) ) AND (x2.cod_con = x3.cod_con ) ) AND (x1.cod_pla = x3.cod_pla ) )
AND (x4.cod_pac = x1.cod_pac ) );

create view admwpd.fapla_cad (cod_pla,cod_con,nome_plano,venc_em_dias,venc_dia,externo,guia,termo,qtd_fat_rem,recibo_con,preco_auto,tipo_lei_base,eh_inamps,paga_iss,val_caucao,val_parcial,recibo_dep,recibo_ret,matricula,senha,suspenso,perc_pac_int,perc_pac_ext,perc_pac_urg,codigo_tax,setor_com_tax,tipo_com_tax,tipo_pac_autori,codigo_cons_urg,setor_com_urg,tipo_com_urg,qtd_dias_parcial,iss_incide_total,digita_iss_sep,senha_muda_leito,qtd_lim_atend,qtd_lim_dias,entrega_exa_domic,val_cau_part_sguia,fatura_mae,qtd_pac_fat_urg,qtd_pac_rem,observacao,tipo_plano,valor_franquia_int,valor_franquia_ext,valor_franquia_urg,valor_franquia_amb,num_ans,validade_cartao) as select x0.cod_pla ,x0.cod_con ,x0.nome_plano ,x0.venc_em_dias ,x0.venc_dia ,x0.externo ,x0.guia ,x0.termo ,x0.qtd_fat_rem ,x0.recibo_con ,x0.preco_auto ,x0.tipo_lei_base ,x0.eh_inamps ,x0.paga_iss ,x0.val_caucao ,x0.val_parcial ,x0.recibo_dep ,x0.recibo_ret ,x0.matricula ,x0.senha ,x0.suspenso ,x0.perc_pac_int ,x0.perc_pac_ext ,x0.perc_pac_urg ,x0.codigo_tax ,x0.setor_com_tax ,x0.tipo_com_tax ,x0.tipo_pac_autori ,x0.codigo_cons_urg ,x0.setor_com_urg ,x0.tipo_com_urg ,x0.qtd_dias_parcial ,x0.iss_incide_total ,x0.digita_iss_sep ,x0.senha_muda_leito ,x0.qtd_lim_atend ,x0.qtd_lim_dias ,x0.entrega_exa_domic ,x0.val_cau_part_sguia ,x0.fatura_mae ,x0.qtd_pac_fat_urg ,x0.qtd_pac_rem ,x0.observacao ,x0.tipo_plano ,x0.valor_franquia_int ,x0.valor_franquia_ext ,x0.valor_franquia_urg ,x0.valor_franquia_amb ,x0.num_ans ,x0.validade_cartao from faplacad x0 ;

create view admwpd.fd_exames_kodak (cod_uni,cod_pac,tipo_pac,cod_prd,regiao,data_hora_ped,data_mov,hora_mov,urgente,cod_pro,cod_pro_solic,
cod_access_number,cod_sala,indicacao,obs,celular,tipo_comanda,comanda,celula,cod_pcn)
  as select x3.cod_ala ,x0.cod_pac ,x3.tipo_pac ,x2.cod_prd ,x2.regiao ,x0.data_mov ,x0.data_mov ,x0.hora_mov ,x2.urgente ,x2.cod_pro ,
  x2.cod_pro_solic ,x2.pk_immprd ,x2.cod_sala ,'' ,x0.observacao ,x4.celular ,x2.tipo_comanda ,x2.comanda ,x1.cod_cel ,x5.cod_pcn
  from admwpd.immovcad x0 ,admwpd.fa_set x1 ,admwpd.immovprd x2 ,admwpd.fapaccad x3 ,admwpd.faprtcad x4 ,admwpd.fapaccom x5
  where ((((((x2.comanda = x0.comanda ) AND (x2.tipo_comanda = x0.tipo_comanda ) ) AND (x3.cod_prt = x4.cod_prt ) )
  AND (x0.cod_pac = x3.cod_pac ) ) AND (x1.cod_set = x0.set_ima ) ) AND (x3.cod_pac = x5.cod_pac ) ) ;

TABELAS -->

CREATE TABLE integra_ris (
  cod_access_number CHAR(10),
  cod_status_intgr CHAR(1),
  data_atlz DATE,
  hora_atlz DATE
  )
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE WPDDADOS;


CREATE UNIQUE INDEX rp_integra_ris_01 ON integra_ris (cod_access_number)
