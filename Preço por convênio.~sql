--Conferir o que está com preço
select u.tipo_prd, t.codigo, u.descricao, u.cod_cbhpm, u.co_tuss, t.coef_filme, t.coef_honor, t.custo_oper, t.valor, 
t.indice_cbhpm, t.cod_porte, t.rowid from faprecad t, faprdcad u, faapetab v
where t.codigo = u.codigo and t.tabela = v.tabela and u.tipo_prd = v.tipo_prd
and u.tipo_prd in ('END','EXA','FIS','LAB','MEN','PRO','RAD','RAT','REM','TOM','USG','VIS')
--and u.tipo_prd in ('PRO','FIS','VIS')--Tipo HON
--and u.tipo_prd = 'CON' and t.tabela = '94'
and t.validade = '13/11/2017' and t.tabela = '87'/* and u.bloqueado = 'N' */order by 4


--Pegar códigos por tipo de produto:
select a.cod_cbhpm, a.codigo, a.co_tuss, a.tipo_prd from faprdcad a
where a.tipo_prd in ('END','EXA','FIS','LAB','MEN','PRO','RAD','RAT','REM','TOM','USG','VIS') order by 1

--Tabela para atualizar
select t.*, t.rowid from faprecad t where t.tabela = '86' and t.validade = '13/11/2017'
and t.codigo in (select codigo from faprdcad where tipo_prd in ('END','EXA','FIS','LAB','MEN','PRO','RAD','RAT','REM','TOM','USG','VIS'))
--and t.codigo in (select codigo from faprdcad where tipo_prd in ('PRO','FIS','VIS'))

select t.*, t.rowid from faprecad t where t.validade = '20/10/2017'
and t.codigo in (select codigo from faprdcad where tipo_prd in ('MQU'))


--
select codigo, tipo_prd from faprdcad where bloqueado = 'N'

select u.cod_cbhpm, u.descricao, t.*, t.rowid from faprecad t, faprdcad u
where t.codigo = u.codigo and t.tabela = '09' and t.validade = '01/12/2016' and u.tipo_prd in 
('END','EXA','FIS','LAB','MEN','PRO','RAD','RAT','REM','TOM','USG','VIS') and u.bloqueado = 'N' order by 1

--and t.codigo in (select codigo from faprdcad where tipo_prd in ('LAB','END','EXA','RAD','RAT','REM','TOM','USG','PRO','FIS','VIS','MEN') and bloqueado = 'N')
and t.codigo in (select codigo from faprdcad where tipo_prd in ('PRO', 'VIS'))
--and t.codigo in (select codigo from faprdcad where tipo_prd = 'FIS')
--and t.codigo in ('230002','000093','000095','224620','224621','224622','000243','000246','000337','217255','224635','224242','224636','224637','224638','220519','217506','223444','224640','220287','224641','224642','226511','227011','001673','221404','004259','004267','224721','004898','218091','221811','005442','217568','217820','230545','008710','008720','008750','008810','008960','008980','008990','008995','009000','009015','009020','009040','009045','009080','009081','009090','009101','009130','009160','009170','009190','009195','049785','049849','049855','055462','049867','049877','215949','227231','056701','229974','218124','215976','224950','205580','225873','051039','215964','051077','051081','051084','051246','230631','159538','051348','051446','225830','220304','051165','051618','227268','220002','220001','222209','222079','229106','225818')
--and t.codigo in(select codigo from faprdcad where cod_cbhpm in
('20101198','20102011','20102020','20102038','20102062','20102100','20104235','20201044','20202024','40101010','40101029','40101045','40101053','40101061','40102017','40102025','40102033','40102041','40102050','40102068','40102084','40102092','40102106','40103013','40103021','40103048','40103064','40103072','40103080','40103099','40103102','40103110','40103137','40103161','40103234','40103242','40103250','40103269','40103285','40103307','40103382','40103404','40103412','40103420','40103439','40103447','40103455','40103463','40103480','40103498','40103501','40103528','40103536','40103544','40103560','40103579','40103587','40103595','40103609','40103617','40103625','40103641','40103650','40103668','40103684','40103714','40103722','40103730','40103749','40103757','40103803','40103820','40104010','40105016','40105024','40105032','40105040','40105059','40105067','40105075','40105083','40105091','40105105','40105113','40105121','40105130','40201015','40301044','40302024','40302709','40302717','40302725','40302733','40302768','40304086','40304256','40304485','40304671','40304930','40304949','40305228','40305775','40305783','40306798','40307603','40307719','40307883','40308154','40308197','40308286','40308294','40308405','40309029','40309100','40309118','40309126','40312160','40314251','40314286','40316157','40316564','40321142','40321410','40321460','40321517','40321525','40321568','40321681','40324559','40324567','40402070','40402169','40403084','40403130','40403149','40403157','40403220','40403300','40403319','40403327','40403335','40403343','40403351','40403360','40403378','40403386','40403394','40403424','40403432','40403440','40403459','40403467','40403475','40403505','40403513','40403548','40403696','40403700','40403718','40403912','40403939','40403947','40403955','40403963','40403971','40403980','40403998','40404021','40501027','40501035','40501060','40501078','40501086','40501094','40501108','40501124','40501132','40701018','40701026','40701034','40701050','40701107','40701115','40701123','40702014','40702022','40702049','40702057','40702065','40702090','40703010','40703029','40703037','40703045','40703053','40703061','40703088','40704017','40704025','40704033','40704041','40704050','40704084','40705013','40706010','40707016','40707032','40707040','40707059','40707075','40707083','40708012','40708039','40708047','40708055','40708063','40708071','40708080','40708098','40708101','40709027','40711013','40711021','40801012','40801020','40801039','40801047','40801055','40801071','40801080','40801098','40801101','40801110','40801136','40801144','40801152','40801209','40802019','40802027','40802035','40802043','40802051','40802060','40802078','40802086','40802094','40802108','40802116','40803015','40803023','40803031','40803040','40803058','40803066','40803074','40803082','40803090','40803104','40803112','40803120','40803139','40803147','40804011','40804020','40804038','40804046','40804054','40804062','40804070','40804089','40804097','40804100','40804119','40804127','40804135','40805018','40805026','40805034','40805042','40805050','40805069','40805077','40806014','40806022','40806030','40806049','40806057','40806065','40806073','40806081','40806090','40806103','40806111','40806189','40807010','40807029','40807037','40807045','40807053','40807061','40807070','40808017','40808025','40808033','40808041','40808114','40808149','40808157','40808165','40809013','40809021','40809030','40809048','40809056','40809064','40809072','40809080','40809110','40810046','40811018','40811026','40812014','40812081','40812103','40812111','40901017','40901025','40901041','40901050','40901068','40901076','40901084','40901092','40901106','40901122','40901130','40901149','40901220','40901238','40901246','40901254','40901289','40901297','40901300','40901327','40901335','40901351','40901360','40901378','40901394','40901408','40901416','40901424','40901432','40901440','40901459','40901467','40901475','40901483','40901513','40901521','40901530','40901572','40901602','40902013','40902064','40902137','41001036','41001044','41001133','41001192','41002016','41101022','41101057','41101065','41101073','41101090','41101146','41101154','41101189','41101316','41101332','41101340','41101359','41101383','41102010','41301013','41301021','41301030','41301048','41301056','41301064','41301072','41301080','41301099','41301110','41301129','41301145','41301153','41301161','41301170','41301188','41301226','41301242','41301250','41301269','41301277','41301307','41301315','41301323','41301331','41301358','41301366','41301382','41301390','41301439','41301447','41301463','41301471','41401042','41401050','41401069','41401077','41401085','41401093','41401107','41401131','41401166','41401174','41401182','41401190','41401204','41401212','41401220','41401239','41401247','41401263','41401271','41401280','41401298','41401301','41401360','41401379','41401387','41401395','41401409','41401425','41401433','41401441','41401450','41401476','41401484','41401492','41401514','41401522','41401603','41401646','41501012','41501020','41501047','41501063','41501071','41501080','41501098','41501101','41501128','41501136','41501144','41501195','41501241','41501250'))

--Pegar códigos que constam na tabela de preço especificada
select a.codigo, a.cod_cbhpm, a.porte_anes_cbhpm, a.num_aux, a.mnemonico, a.tipo_prd from faprdcad a
where a.tipo_prd in ('LAB','END','EXA','RAD','RAT','REM','TOM','USG','PRO','FIS','VIS','MEN') and a.bloqueado = 'N'
and a.codigo in (select codigo from faprecad where tabela = '30' and validade = '01/01/2017')
and a.cod_cbhpm is not null order by 2

--Equivalências ativas (com preço):
select b.tipo_prd, a.codigo, b.descricao, a.cod_equ, b.co_tuss, c.valor
from faecpcad a, faprdcad b, faprecad c
where a.codigo = b.codigo and b.codigo = c.codigo
and a.cod_con = '048'
and c.validade = '01/01/2017' and c.tabela = '30' and b.bloqueado = 'N'
and b.tipo_prd in ('GMD', 'DIA', 'TAX', 'VID') order by b.tipo_prd

select t.*, t.rowid from faprecad t where t.validade = '01/10/2016'
and t.codigo in ('225061','003583') order by 1
