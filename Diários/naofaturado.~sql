drop table naofaturado;
create global temporary table naofaturado (fatpac decimal(15,2), fatcon decimal(15,2));
insert into naofaturado values(
(SELECT SUM(FAMOVDESTINO.VALOR_TOT * DECODE(REQ_DEV,'R',1,-1)) FROM FAMOVPRD, FAMOVCAD, FAMOVDESTINO, FAPACCAD FPC
        WHERE FAMOVCAD.COD_PAC=FPC.COD_PAC AND FAMOVCAD.COMANDA=FAMOVPRD.COMANDA AND FAMOVCAD.TIPO_COMANDA=FAMOVPRD.TIPO_COMANDA
        AND FAMOVPRD.SEQUENCIAL=FAMOVDESTINO.SEQUENCIAL
        AND (((FAMOVDESTINO.COD_FATURA = ' ') OR (FAMOVDESTINO.COD_FATURA IS NULL)) AND FAMOVDESTINO.DESTINO='P')
        AND (FAMOVPRD.TIPO_PGTO <> 'N' OR FAMOVPRD.TIPO_PGTO IS NULL OR FAMOVPRD.TIPO_PGTO = ' ' )
        AND FAMOVDESTINO.COD_UNI_COBRANCA IN ('0001')
        AND FPC.DATA_ENT >= '01/11/2012'  AND FPC.DATA_ENT <= '02/11/2012'),
(SELECT SUM(FAMOVDESTINO.VALOR_TOT * DECODE(REQ_DEV,'R',1,-1)) FROM FAMOVPRD, FAMOVCAD, FAMOVDESTINO, FAPACCAD FPC
        WHERE FAMOVCAD.COD_PAC=FPC.COD_PAC AND FAMOVCAD.COMANDA=FAMOVPRD.COMANDA AND FAMOVCAD.TIPO_COMANDA=FAMOVPRD.TIPO_COMANDA
        AND FAMOVPRD.SEQUENCIAL = FAMOVDESTINO.SEQUENCIAL
        AND (((FAMOVDESTINO.COD_FATURA = ' ') OR (FAMOVDESTINO.COD_FATURA IS NULL)) AND FAMOVDESTINO.DESTINO = 'C')
        AND (FAMOVPRD.TIPO_PGTO <> 'N' OR FAMOVPRD.TIPO_PGTO IS NULL OR FAMOVPRD.TIPO_PGTO = ' ')
        AND FAMOVDESTINO.COD_UNI_COBRANCA IN ('0001')
        AND FPC.DATA_ENT >= '01/11/2012'  AND FPC.DATA_ENT <= '30/11/2012'));
select nvl(fatpac,0)+nvl(fatcon,0) from naofaturado;
select * from naofaturado;
